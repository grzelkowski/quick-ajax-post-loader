!function(a){const t={init:function(){this.qapl_quick_ajax_handlers(),this.qapl_quick_ajax_initial_load(),this.qapl_quick_ajax_infinite_scroll()},qapl_quick_ajax_handlers:function(){if("undefined"!=typeof qapl_quick_ajax_helper&&qapl_quick_ajax_helper){const t=this;qapl_quick_ajax_helper.helper.load_more_data_button&&a(".quick-ajax-posts-container").on("click",`[data-button="${qapl_quick_ajax_helper.helper.load_more_data_button}"]`,(function(){t.qapl_quick_ajax_handle_ajax(a(this))})),qapl_quick_ajax_helper.helper.filter_data_button&&a(".quick-ajax-filter-container").on("click",`[data-button="${qapl_quick_ajax_helper.helper.filter_data_button}"]`,(function(){t.qapl_quick_ajax_handle_ajax(a(this))})),qapl_quick_ajax_helper.helper.sort_button&&a(".quick-ajax-sort-options-container").on("click",`[data-button="${qapl_quick_ajax_helper.helper.sort_button}"]`,(function(){t.qapl_quick_ajax_handle_ajax(a(this))})),a("body").on("change",'select[name="quick_ajax_sort_option"]',(function(){t.qapl_quick_ajax_handle_sort(a(this))}))}},qapl_quick_ajax_initial_load:function(){const t=this,e=a(".qapl-initial-loader");e.length>0&&t.qapl_quick_ajax_handle_ajax(e)},qapl_quick_ajax_infinite_scroll:function(){a(".quick-ajax-load-more-container.infinite-scroll").each((function(){new IntersectionObserver((function(t){t.forEach((function(t){if(t.isIntersecting){const e=a(t.target).find('button[data-button="'+qapl_quick_ajax_helper.helper.load_more_data_button+'"]');e.length&&!e.hasClass("loading")&&(e.addClass("loading"),e.trigger("click"))}}))}),{root:null,rootMargin:"0px",threshold:.5}).observe(this)}))},qapl_quick_ajax_handle_ajax:function(t){const e=this;let i={},n={};try{if(i=JSON.parse(t.attr("data-action")||"{}"),n=JSON.parse(t.attr("data-attributes")||"{}"),"object"!=typeof i||"object"!=typeof n)throw new Error("Quick Ajax Post Loader: Invalid JSON structure")}catch(a){return}const o=t.attr("data-button"),_=n[qapl_quick_ajax_helper.helper.block_id]||"",l=a("#quick-ajax-"+_),r=a("#quick-ajax-"+_+" .quick-ajax-posts-wrapper");if(l.length&&r.length){if(l.find(".quick-ajax-end-message-container").remove(),l.addClass("loading"),l.hasClass("quick-ajax-theme")){const a=r.find(".qapl-post-item:first");a.length&&l.css("min-height",a.outerHeight()+"px")}o!==qapl_quick_ajax_helper.helper.filter_data_button&&o!==qapl_quick_ajax_helper.helper.sort_button||(l.addClass("filter-update"),r.fadeOut(100,(function(){a(this).empty().fadeIn(100)}))),a.ajax({url:qapl_quick_ajax_helper.ajax_url,type:"POST",data:{action:"qapl_quick_ajax_load_posts",nonce:qapl_quick_ajax_helper.nonce,args:i,attributes:n,button_type:o},success:function(a){a&&a.data&&(o===qapl_quick_ajax_helper.helper.load_more_data_button?e.qapl_quick_ajax_load_more_add_posts(r,t,a.data.output):o!==qapl_quick_ajax_helper.helper.filter_data_button&&o!==qapl_quick_ajax_helper.helper.sort_button||e.qapl_quick_ajax_taxonomy_filter_show_posts(r,t,a.data.output,_),e.qapl_quick_ajax_append_load_more_button(r,a.data.load_more)),l.removeClass("loading"),setTimeout((function(){l.removeClass("filter-update")}),200),e.qapl_quick_ajax_append_end_message(l,a.data.show_end_message)},error:function(a,t,e){l.removeClass("loading"),setTimeout((function(){l.removeClass("filter-update")}),200)}})}},qapl_quick_ajax_load_more_add_posts:function(t,e,i){e.parent().remove();const n=a(i).hide();t.append(n),n.slideDown((function(){a(this).removeAttr("style")}))},qapl_quick_ajax_taxonomy_filter_show_posts:function(t,e,i,n){a("#quick-ajax-filter-"+n).find(`[data-button="${qapl_quick_ajax_helper.helper.filter_data_button}"]`).removeClass("active"),e.addClass("active"),t.parent().find(".quick-ajax-load-more-container").remove(),t.stop(!0,!0).fadeOut(100,(function(){const e=a(i).css("opacity","0");t.html(e).fadeIn(400),e.animate({opacity:1},{duration:400,complete:function(){a(this).removeAttr("style")}})}))},qapl_quick_ajax_append_load_more_button:function(a,t){t&&(a.parent().find(".quick-ajax-load-more-container").remove(),a.parent().append(t),this.qapl_quick_ajax_infinite_scroll())},qapl_quick_ajax_append_end_message:function(a,t){t&&a.append(t)},qapl_quick_ajax_handle_sort:function(t){const e=t.closest(".quick-ajax-sort-options-container").find(".quick-ajax-settings"),i=e.data("attributes");if(!i||!i.quick_ajax_id)return;const n=i.quick_ajax_id,o=a("#quick-ajax-filter-"+n),_=t.val(),[l="",r=""]=_.split("-");let c=e.data("action");if("string"==typeof c)try{c=JSON.parse(c)}catch(a){return}if(c.orderby=l,c.order=r,e.attr("data-action",JSON.stringify(c)),!o.length)return void(e.is("[data-action]")&&e.trigger("click"));o.find(".qapl-filter-button").each((function(){const t=a(this);let e=t.data("action");if("string"==typeof e)try{e=JSON.parse(e)}catch(a){return}e.orderby=l,e.order=r,t.attr("data-action",JSON.stringify(e))}));const u=o.find(".qapl-filter-button.active");u.length?u.trigger("click"):e.is("[data-action]")&&e.trigger("click")}};a(document).ready((function(){t.init()}))}(jQuery);