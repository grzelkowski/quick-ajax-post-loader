!function(a){var t={init:function(){this.qapl_quick_ajax_handlers(),this.qapl_quick_ajax_initial_load(),this.qapl_quick_ajax_infinite_scroll()},qapl_quick_ajax_handlers:function(){if("undefined"!=typeof qapl_quick_ajax_helper&&qapl_quick_ajax_helper){var t=this;qapl_quick_ajax_helper.helper.load_more_data_button&&a(".quick-ajax-posts-container").on("click",`[data-button="${qapl_quick_ajax_helper.helper.load_more_data_button}"]`,(function(){t.qapl_quick_ajax_handle_ajax(a(this))})),qapl_quick_ajax_helper.helper.filter_data_button&&a(".quick-ajax-filter-container").on("click",`[data-button="${qapl_quick_ajax_helper.helper.filter_data_button}"]`,(function(){t.qapl_quick_ajax_handle_ajax(a(this))})),qapl_quick_ajax_helper.helper.sort_button&&a(".quick-ajax-sort-options-container").on("click",`[data-button="${qapl_quick_ajax_helper.helper.sort_button}"]`,(function(){t.qapl_quick_ajax_handle_ajax(a(this))})),a("body").on("change",'select[name="quick_ajax_sort_option"]',(function(){t.qapl_quick_ajax_handle_sort(a(this))}))}},qapl_quick_ajax_initial_load:function(){var t=a(".qapl-initial-loader");t.length>0&&this.qapl_quick_ajax_handle_ajax(t)},qapl_quick_ajax_infinite_scroll:function(){a(".quick-ajax-load-more-container.infinite-scroll").each((function(){new IntersectionObserver((function(t){t.forEach((function(t){if(t.isIntersecting){var e=a(t.target).find('button[data-button="'+qapl_quick_ajax_helper.helper.load_more_data_button+'"]');e.length&&!e.hasClass("loading")&&(e.addClass("loading"),e.trigger("click"))}}))}),{root:null,rootMargin:"0px",threshold:.5}).observe(this)}))},qapl_quick_ajax_handle_ajax:function(t){var e=this;try{var i=JSON.parse(t.attr("data-action")||"{}"),n=JSON.parse(t.attr("data-attributes")||"{}");if("object"!=typeof i||"object"!=typeof n)throw new Error("Quick Ajax Post Loader: Invalid JSON structure")}catch(a){return}var _=t.attr("data-button"),o=n[qapl_quick_ajax_helper.helper.block_id]||"",r=a("#quick-ajax-"+o),l=a("#quick-ajax-"+o+" .quick-ajax-posts-wrapper");r.length&&l.length&&(r.addClass("loading"),t.attr("data-button")!==qapl_quick_ajax_helper.helper.filter_data_button&&t.attr("data-button")!==qapl_quick_ajax_helper.helper.sort_button||l.fadeOut(100,(function(){a(this).empty().fadeIn(100)})),a.ajax({url:qapl_quick_ajax_helper.ajax_url,type:"POST",data:{action:"qapl_quick_ajax_load_posts",nonce:qapl_quick_ajax_helper.nonce,args:i,attributes:n,button_type:_},success:function(a){a&&a.data&&(_===qapl_quick_ajax_helper.helper.load_more_data_button?e.qapl_quick_ajax_load_more_add_posts(l,t,a.data.output):t.attr("data-button")!==qapl_quick_ajax_helper.helper.filter_data_button&&t.attr("data-button")!==qapl_quick_ajax_helper.helper.sort_button||e.qapl_quick_ajax_taxonomy_filter_show_posts(l,t,a.data.output),e.qapl_quick_ajax_append_load_more_button(l,a.data.load_more)),r.removeClass("loading")},error:function(a,t,e){r.removeClass("loading")}}))},qapl_quick_ajax_load_more_add_posts:function(t,e,i){e.parent().remove();var n=a(i).hide();t.append(n),n.slideDown((function(){a(this).removeAttr("style")}))},qapl_quick_ajax_taxonomy_filter_show_posts:function(t,e,i){a(`[data-button="${qapl_quick_ajax_helper.helper.filter_data_button}"]`).removeClass("active"),e.addClass("active"),t.parent().find(".quick-ajax-load-more-container").remove();var n=a(i).css("opacity","0");t.html(n),n.animate({opacity:1},{duration:400,complete:function(){a(this).removeAttr("style")}})},qapl_quick_ajax_append_load_more_button:function(a,t){t&&(a.parent().find(".quick-ajax-load-more-container").remove(),a.parent().append(t),this.qapl_quick_ajax_infinite_scroll())},qapl_quick_ajax_handle_sort:function(t){let e=t.closest(".quick-ajax-sort-options-container").find(".quick-ajax-settings"),i=e.data("attributes");if(!i||!i.quick_ajax_id)return;let n=i.quick_ajax_id,_=a("#quick-ajax-filter-"+n),o=t.val(),[r,l]=o.split("-"),c=e.data("action");if("string"==typeof c&&(c=JSON.parse(c)),c.orderby=r,c.order=l,e.attr("data-action",JSON.stringify(c)),!_.length)return void(e.is("[data-action]")&&e.trigger("click"));_.find(".qapl-filter-button").each((function(){let t=a(this),e=t.data("action");"string"==typeof e&&(e=JSON.parse(e)),e.orderby=r,e.order=l,t.attr("data-action",JSON.stringify(e))}));let u=_.find(".qapl-filter-button.active");u.length?u.trigger("click"):e.is("[data-action]")&&e.trigger("click")}};a(document).ready((function(){t.init()}))}(jQuery);