!function(a){const t={init:function(){this.qapl_quick_ajax_handlers(),this.qapl_quick_ajax_initial_load(),this.qapl_quick_ajax_infinite_scroll()},qapl_quick_ajax_handlers:function(){if("undefined"!=typeof qapl_quick_ajax_data&&qapl_quick_ajax_data){const t=this;qapl_quick_ajax_data.constants.load_more_data_button&&a(".quick-ajax-posts-container").on("click",`[data-button="${qapl_quick_ajax_data.constants.load_more_data_button}"]`,(function(){t.qapl_quick_ajax_handle_ajax(a(this))})),qapl_quick_ajax_data.constants.filter_data_button&&a(".quick-ajax-filter-container").on("click",`[data-button="${qapl_quick_ajax_data.constants.filter_data_button}"]`,(function(){t.qapl_quick_ajax_handle_ajax(a(this))})),qapl_quick_ajax_data.constants.sort_button&&a(".quick-ajax-sort-options-container").on("click",`[data-button="${qapl_quick_ajax_data.constants.sort_button}"]`,(function(){t.qapl_quick_ajax_handle_ajax(a(this))})),a("body").on("change",'select[name="quick_ajax_sort_option"]',(function(){t.qapl_quick_ajax_handle_sort(a(this))}))}},qapl_quick_ajax_initial_load:function(){const t=this,n=a(".qapl-initial-loader");n.length>0&&n.each((function(){const n=a(this);t.qapl_quick_ajax_handle_ajax(n)}))},qapl_quick_ajax_infinite_scroll:function(){a(".quick-ajax-load-more-container.infinite-scroll").each((function(){new IntersectionObserver((function(t){t.forEach((function(t){if(t.isIntersecting){const n=a(t.target).find('button[data-button="'+qapl_quick_ajax_data.constants.load_more_data_button+'"]');n.length&&!n.hasClass("loading")&&(n.addClass("loading"),n.trigger("click"))}}))}),{root:null,rootMargin:"0px",threshold:.5}).observe(this)}))},qapl_quick_ajax_handle_ajax:function(t){const n=this;let i={},o={};try{if(i=JSON.parse(t.attr("data-action")||"{}"),o=JSON.parse(t.attr("data-attributes")||"{}"),"object"!=typeof i||"object"!=typeof o)throw new Error("Quick Ajax Post Loader: Invalid JSON structure")}catch(a){return}const _=t.attr("data-button"),e=o[qapl_quick_ajax_data.constants.block_id]||"",c=a("#quick-ajax-"+e),s=a("#quick-ajax-"+e+" .quick-ajax-posts-wrapper");if(c.length&&s.length){if(c.find(".quick-ajax-end-message-container").remove(),c.addClass("loading"),c.hasClass("quick-ajax-theme")){const a=s.find(".qapl-post-item:first");a.length&&c.css("min-height",a.outerHeight()+"px")}_!==qapl_quick_ajax_data.constants.filter_data_button&&_!==qapl_quick_ajax_data.constants.sort_button||(c.addClass("filter-update"),s.fadeOut(100,(function(){a(this).empty().fadeIn(100)}))),a.ajax({url:qapl_quick_ajax_data.ajax_url,type:"POST",data:{action:"qapl_quick_ajax_load_posts",nonce:qapl_quick_ajax_data.nonce,args:i,attributes:o,button_type:_},success:function(a){a&&a.data&&(_===qapl_quick_ajax_data.constants.load_more_data_button?n.qapl_quick_ajax_load_more_add_posts(s,t,a.data.output):_!==qapl_quick_ajax_data.constants.filter_data_button&&_!==qapl_quick_ajax_data.constants.sort_button||n.qapl_quick_ajax_taxonomy_filter_show_posts(s,t,a.data.output,e),n.qapl_quick_ajax_append_load_more_button(s,a.data.load_more)),c.removeClass("loading"),setTimeout((function(){c.removeClass("filter-update")}),200),n.qapl_quick_ajax_append_end_message(c,a.data.show_end_message)},error:function(a,t,n){c.removeClass("loading"),setTimeout((function(){c.removeClass("filter-update")}),200)}})}},qapl_quick_ajax_load_more_add_posts:function(t,n,i){n.parent().remove();const o=a(i).hide();t.append(o),o.slideDown((function(){a(this).removeAttr("style")}))},qapl_quick_ajax_taxonomy_filter_show_posts:function(t,n,i,o){let _=a("#quick-ajax-filter-"+o);n.hasClass("qapl-initial-loader")||_.find(`[data-button="${qapl_quick_ajax_data.constants.filter_data_button}"]`).removeClass("active"),n.addClass("active"),t.parent().find(".quick-ajax-load-more-container").remove(),t.stop(!0,!0).fadeOut(100,(function(){const n=a(i).css("opacity","0");t.html(n).fadeIn(400),n.animate({opacity:1},{duration:400,complete:function(){a(this).removeAttr("style")}})}))},qapl_quick_ajax_append_load_more_button:function(a,t){t&&(a.parent().find(".quick-ajax-load-more-container").remove(),a.parent().append(t),this.qapl_quick_ajax_infinite_scroll())},qapl_quick_ajax_append_end_message:function(a,t){t&&a.append(t)},qapl_quick_ajax_handle_sort:function(t){const n=t.closest(".quick-ajax-sort-options-container").find(".quick-ajax-settings"),i=n.data("attributes");if(!i||!i.quick_ajax_id)return;const o=i.quick_ajax_id,_=a("#quick-ajax-filter-"+o),e=t.val(),[c="",s=""]=e.split("-");let l=n.data("action");if("string"==typeof l)try{l=JSON.parse(l)}catch(a){return}if(l.orderby=c,l.order=s,n.attr("data-action",JSON.stringify(l)),!_.length)return void(n.is("[data-action]")&&n.trigger("click"));_.find(".qapl-filter-button").each((function(){const t=a(this);let n=t.data("action");if("string"==typeof n)try{n=JSON.parse(n)}catch(a){return}n.orderby=c,n.order=s,t.attr("data-action",JSON.stringify(n))}));const r=_.find(".qapl-filter-button.active");r.length?r.trigger("click"):n.is("[data-action]")&&n.trigger("click")}};a(document).ready((function(){t.init()}))}(jQuery);