!function(e){var t={helper_available:"undefined"!=typeof qapl_quick_ajax_helper&&qapl_quick_ajax_helper,init:function(){this.click_and_select_shortcode(),this.click_and_select_all(),this.handle_post_type_change(),this.handle_taxonomy_change(),this.show_hide_element_on_change(),this.quick_ajax_tabs(),this.copy_code(),this.quick_ajax_function_generator(),this.accordion_block_toggle()},handle_post_type_change:function(){if(!this.helper_available)return;const t=this,a=e("#"+qapl_quick_ajax_helper.quick_ajax_settings_wrapper+" #"+qapl_quick_ajax_helper.quick_ajax_post_type);a.length&&a.on("change",(function(){const a=e(this).val();e.ajax({url:qapl_quick_ajax_helper.ajax_url,type:"POST",data:{action:"qapl_quick_ajax_get_taxonomies_by_post_type",post_type:a,nonce:qapl_quick_ajax_helper.nonce},success:function(a){if(a&&a.data){const n=e("#"+qapl_quick_ajax_helper.quick_ajax_settings_wrapper+" #"+qapl_quick_ajax_helper.quick_ajax_taxonomy);n.empty(),n.append(a.data),t.trigger_taxonomy_change()}},error:function(e,t,a){}})}))},handle_taxonomy_change:function(){if(!this.helper_available)return;const t=this,a=e("#"+qapl_quick_ajax_helper.quick_ajax_settings_wrapper+" #"+qapl_quick_ajax_helper.quick_ajax_taxonomy),n=e("#"+qapl_quick_ajax_helper.quick_ajax_settings_wrapper+" #"+qapl_quick_ajax_helper.quick_ajax_manual_selected_terms);a.length&&a.on("change",(function(){n.empty(),t.admin_page_loader(n);let a=e(this).val(),_="";e("#post_ID").length&&(_=e("#post_ID").val()),e.ajax({url:qapl_quick_ajax_helper.ajax_url,type:"POST",data:{action:"qapl_quick_ajax_get_terms_by_taxonomy",taxonomy:a,post_id:_,nonce:qapl_quick_ajax_helper.nonce},success:function(e){e&&e.data&&n.fadeOut(100,(function(){n.empty(),n.append(e.data),n.fadeIn(100)}))},error:function(e,t,a){}})}))},trigger_taxonomy_change:function(){if(!this.helper_available)return;const t=this,a=e("#"+qapl_quick_ajax_helper.quick_ajax_settings_wrapper+" #"+qapl_quick_ajax_helper.quick_ajax_taxonomy),n=e("#"+qapl_quick_ajax_helper.quick_ajax_settings_wrapper+" #"+qapl_quick_ajax_helper.quick_ajax_manual_selected_terms);n.length&&(t.admin_page_loader(n),a.trigger("change"))},admin_page_loader:function(e){e.append('<div class="qapl-admin-page-loader"><span></span><span></span><span></span></div>')},show_hide_element_on_change:function(){e(".show-hide-trigger input, .show-hide-trigger select").on("change",(function(){e(".quick-ajax-field-container[data-conditional]").each((function(){const t=e(this),a=t.data("conditional");let n=!0;for(const t in a){if(!a.hasOwnProperty(t))continue;const _=a[t],o=e("#"+t);if((o.is(":checkbox")?o.is(":checked")?"1":"0":o.val())!==_){n=!1;break}}n?t.removeClass("inactive"):t.addClass("inactive")}))}))},quick_ajax_tabs:function(){if(e(".quick-ajax-tabs").length){const t=e(".quick-ajax-tab-button"),a=e(".quick-ajax-tab-content");t.on("click",(function(n){n.preventDefault();const _=e(this).data("tab");t.removeClass("active").attr("aria-selected","false").attr("tabindex","-1"),a.removeClass("active").attr("hidden",!0),e(this).addClass("active").attr("aria-selected","true").attr("tabindex","0"),e("#"+_).addClass("active").attr("hidden",!1)})),t.on("keydown",(function(e){const a=t.index(this);let n;if("ArrowRight"===e.key)n=(a+1)%t.length;else{if("ArrowLeft"!==e.key)return;n=(a-1+t.length)%t.length}t.eq(n).focus().click()}))}},copy_code:function(){e(".copy-button").on("click",(function(){var t=e("#"+e(this).data("copy")),a=e("<textarea>").val(t.text()).appendTo("body").select();try{navigator.clipboard.writeText(t.text()).then((()=>{})).catch((e=>{}))}finally{a.remove(),e(this).text("Code Copied"),setTimeout((()=>{e(this).text("Copy Code")}),2e3)}}))},generateId:function(e){let t=0;for(let a=0;a<e.length;a++)t+=e.charCodeAt(a),a%2==0?t+=e.charCodeAt(a):t-=e.charCodeAt(a);return t},getExcludedPostIds:function(e){var t=e.split(/[,\s]+/),a=[];return t.forEach((function(e){/^\d+$/.test(e)&&-1===a.indexOf(e)&&a.push(e)})),a.join(", ")},cleanClassNames:function(e){let t=e.replace(/,/g," ").split(/\s+/);return t=t.filter(((e,t,a)=>!/^\d/.test(e)&&""!==e&&a.indexOf(e)===t)),t.join(", ")},qapl_collect_input_data:function(){const t={};return e(".function-generator-wrap input, .function-generator-wrap select").each((function(a,n){const _=e(n),o=_.attr("name"),i=_.attr("id");if("checkbox"===n.type)if(o&&o.endsWith("[]")){let e=o.replace(/\[\]$/,"");t[e]||(t[e]=[]),_.prop("checked")&&t[e].push(_.val())}else t[i]=_.prop("checked")?1:0;else t[i]=_.val()})),t},qapl_generate_args:function(e){const t=this;let a="",n="",_="";(a+="$quick_ajax_args = [\n",a+="    'post_type' => '"+e.qapl_select_post_type+"',\n",a+="    'posts_per_page' => "+e.qapl_select_posts_per_page+",\n","none"!==e.qapl_select_orderby&&(a+="    'orderby' => '"+e.qapl_select_orderby+"',\n"),a+="    'order' => '"+e.qapl_select_order+"',\n",""!==e.qapl_select_post_not_in)&&(a+="    'post__not_in' => ["+t.getExcludedPostIds(e.qapl_select_post_not_in)+"],\n");if(1===e.qapl_ignore_sticky_posts&&(a+="    'ignore_sticky_posts' => "+e.qapl_ignore_sticky_posts+",\n"),1===e.qapl_show_select_taxonomy&&(a+="    'selected_taxonomy' => '"+e.qapl_select_taxonomy+"',\n"),1===e.qapl_show_select_taxonomy&&1===e.qapl_manual_term_selection){var o=e.qapl_manual_selected_terms;o&&o.length>0&&(n="[",n+=o.map((e=>`${e}`)).join(", "),n+="]"),n&&(a+="    'selected_terms' => "+n+",\n")}let i=a.trimEnd();return i.endsWith(",")&&(a=i.slice(0,-1)+"\n"),a+="];",""!==a.trim()&&(_+="\n// Define AJAX query parameters for '"+e.qapl_select_post_type+"' type posts.\n",_+=a.trim()+"\n"),_},qapl_generate_attributes:function(e,t){const a=this;let n={},_="";n[qapl_quick_ajax_helper.quick_ajax_id]=t,1===e.qapl_layout_quick_ajax_css_style&&(n[qapl_quick_ajax_helper.quick_ajax_css_style]=e.qapl_layout_quick_ajax_css_style,n[qapl_quick_ajax_helper.grid_num_columns]=e.qapl_layout_select_columns_qty),e.qapl_layout_quick_ajax_post_item_template&&(n[qapl_quick_ajax_helper.post_item_template]=e.qapl_layout_quick_ajax_post_item_template),e.qapl_layout_add_taxonomy_filter_class&&""!==e.qapl_layout_add_taxonomy_filter_class&&(n[qapl_quick_ajax_helper.taxonomy_filter_class]=a.cleanClassNames(e.qapl_layout_add_taxonomy_filter_class)),e.qapl_layout_add_container_class&&""!==e.qapl_layout_add_container_class&&(n[qapl_quick_ajax_helper.container_class]=a.cleanClassNames(e.qapl_layout_add_container_class)),1===e.qapl_show_custom_load_more_post_quantity&&(n[qapl_quick_ajax_helper.load_more_posts]=e.qapl_select_custom_load_more_post_quantity),1===e.qapl_override_global_loader_icon&&(n[qapl_quick_ajax_helper.loader_icon]=e.qapl_loader_icon),1===e.qapl_ajax_on_initial_load&&(n[qapl_quick_ajax_helper.ajax_initial_load]=e.qapl_ajax_on_initial_load),1===e.qapl_ajax_infinite_scroll&&(n[qapl_quick_ajax_helper.infinite_scroll]=e.qapl_ajax_infinite_scroll),1===e.qapl_show_end_post_message&&(n[qapl_quick_ajax_helper.show_end_message]=e.qapl_show_end_post_message);var o="";return Object.keys(n).length>0&&(o="",o+="$quick_ajax_attributes = [\n",Object.entries(n).forEach((([e,t])=>{let n;n=a.quick_ajax_is_numeric(t)?parseInt(t):"string"==typeof t?`'${t}'`:t,o+=`    '${e}' => ${n},\n`})),o=o.slice(0,-2)+"\n",o+="];"),""!==o.trim()&&(_+="\n// Define attributes for AJAX.\n",_+=o.trim()+"\n"),_},qapl_generate_sort_controls:function(e){let t=null,a=null;1===e.qapl_show_order_button&&(t=e.qapl_select_orderby_button_options,t&&t.length>0&&(a="$quick_ajax_sort_options = [",a+=t.map((e=>`'${e}'`)).join(", "),a+="];"));var n="",_="";null!==t&&a&&(n="",n+=a,_="",_+="if(function_exists('qapl_render_sort_controls')){\n",_+="    qapl_render_sort_controls(\n",_+="        $quick_ajax_args,\n",_+="        $quick_ajax_attributes,\n",_+="        $quick_ajax_sort_options\n",_+="    );\n",_+="}");let o="";return"string"==typeof n&&""!==n.trim()&&(o+="\n// Set the sort options for the button.\n",o+=n.trim()+"\n"),"string"==typeof _&&""!==_.trim()&&(o+="\n// Render the sorting control button.\n",o+=_.trim()+"\n"),o},qapl_generate_taxonomy_filter:function(e){let t=null,a="",n="";return 1===e.qapl_show_select_taxonomy&&(t=e.qapl_select_taxonomy),null!==t&&(n+="if(function_exists('qapl_render_taxonomy_filter')){\n",n+="    qapl_render_taxonomy_filter(\n",n+="        $quick_ajax_args,\n",n+="        $quick_ajax_attributes,\n",n=n.slice(0,-2)+"\n",n+="    );\n",n+="}"),""!==n.trim()&&(a+="\n// Render the navigation for '"+e.qapl_select_taxonomy+"' taxonomy.\n",a+=n.trim()+"\n"),a},qapl_generate_post_container:function(e,t){let a="",n="";return n+="if(function_exists('qapl_render_post_container')){\n",n+="   qapl_render_post_container(\n",n+="       $quick_ajax_args,\n",""!==t&&(n+="       $quick_ajax_attributes,\n"),n=n.slice(0,-2)+"\n",n+="   );\n",n+="}",""!==n.trim()&&(a+="\n// Render the grid for '"+e.qapl_select_post_type+"' type posts.\n",a+=n.trim()+"\n"),a},quick_ajax_function_generator:function(){const t=this;this.helper_available&&e(".generate-function-button").on("click",(function(){const a=e(this),n=a.attr("data-output"),_=e("#"+n),o=e('.copy-button[data-copy="'+n+'"]');a.prop("disabled",!0),o.prop("disabled",!0);const i=t.qapl_collect_input_data(),l=Object.values(i).join(""),c=t.generateId(l),s=t.qapl_generate_args(i),r=t.qapl_generate_attributes(i,c),p=[s,r,t.qapl_generate_sort_controls(i),t.qapl_generate_taxonomy_filter(i),t.qapl_generate_post_container(i,r)].filter(Boolean).join("");_.empty();for(var u=p.split("\n"),d=0;d<u.length;d++)!function(e){setTimeout((function(){_.append(u[e]+"\n"),e===u.length-1&&(a.prop("disabled",!1),o.prop("disabled",!1))}),50*d)}(d)}))},quick_ajax_is_numeric:function(e){return/^-?\d+(\.\d+)?$/.test(e)},quick_ajax_color_picker:function(){e(".color-picker-field").wpColorPicker()},quick_ajax_select_text:function(e){var t,a;document.body.createTextRange?((t=document.body.createTextRange()).moveToElementText(e),t.select()):window.getSelection&&(a=window.getSelection(),(t=document.createRange()).selectNodeContents(e),a.removeAllRanges(),a.addRange(t))},click_and_select_shortcode:function(){const t=this;e(".quick-ajax-shortcode").on("click",(function(){t.quick_ajax_select_text(this)}))},click_and_select_all:function(){const t=this;e(".click-and-select-all").on("click",(function(){var a=e(this).find("code").get(0);t.quick_ajax_select_text(a)}))},accordion_block_toggle:function(){var t=e("#wpbody-content");if(t.find(".quick-ajax-tabs").length>0){var a=e("#adminmenuwrap").outerHeight();t.css("min-height",a)}e(".quick-ajax-accordion-toggle").click((function(){e(this).toggleClass("active").next(".quick-ajax-accordion-content").slideToggle(200)}))}};e(document).ready((function(){t.init()}))}(jQuery);