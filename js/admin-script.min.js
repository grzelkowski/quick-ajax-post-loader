!function(a){var t={data_available:"undefined"!=typeof qapl_quick_ajax_admin_data&&qapl_quick_ajax_admin_data,init:function(){this.click_and_select_shortcode(),this.click_and_select_all(),this.handle_post_type_change(),this.handle_taxonomy_change(),this.show_hide_element_on_change(),this.quick_ajax_tabs(),this.copy_code(),this.quick_ajax_function_generator(),this.accordion_block_toggle()},handle_post_type_change:function(){if(!this.data_available)return;const t=this,n=a("#"+qapl_quick_ajax_admin_data.constants.quick_ajax_settings_wrapper+" #"+qapl_quick_ajax_admin_data.constants.quick_ajax_post_type);n.length&&n.on("change",(function(){const n=a(this).val();a.ajax({url:qapl_quick_ajax_admin_data.ajax_url,type:"POST",data:{action:"qapl_quick_ajax_get_taxonomies_by_post_type",post_type:n,nonce:qapl_quick_ajax_admin_data.nonce},success:function(n){if(n&&n.data){const e=a("#"+qapl_quick_ajax_admin_data.constants.quick_ajax_settings_wrapper+" #"+qapl_quick_ajax_admin_data.constants.quick_ajax_taxonomy);e.empty(),e.append(n.data),t.trigger_taxonomy_change()}},error:function(a,t,n){}})}))},handle_taxonomy_change:function(){if(!this.data_available)return;const t=this,n=a("#"+qapl_quick_ajax_admin_data.constants.quick_ajax_settings_wrapper+" #"+qapl_quick_ajax_admin_data.constants.quick_ajax_taxonomy),e=a("#"+qapl_quick_ajax_admin_data.constants.quick_ajax_settings_wrapper+" #"+qapl_quick_ajax_admin_data.constants.quick_ajax_manual_selected_terms);n.length&&n.on("change",(function(){e.empty(),t.admin_page_loader(e);let n=a(this).val(),_="";a("#post_ID").length&&(_=a("#post_ID").val()),a.ajax({url:qapl_quick_ajax_admin_data.ajax_url,type:"POST",data:{action:"qapl_quick_ajax_get_terms_by_taxonomy",taxonomy:n,post_id:_,nonce:qapl_quick_ajax_admin_data.nonce},success:function(a){a&&a.data&&e.fadeOut(100,(function(){e.empty(),e.append(a.data),e.fadeIn(100)}))},error:function(a,t,n){}})}))},trigger_taxonomy_change:function(){if(!this.data_available)return;const t=this,n=a("#"+qapl_quick_ajax_admin_data.constants.quick_ajax_settings_wrapper+" #"+qapl_quick_ajax_admin_data.constants.quick_ajax_taxonomy),e=a("#"+qapl_quick_ajax_admin_data.constants.quick_ajax_settings_wrapper+" #"+qapl_quick_ajax_admin_data.constants.quick_ajax_manual_selected_terms);e.length&&(t.admin_page_loader(e),n.trigger("change"))},admin_page_loader:function(a){a.append('<div class="qapl-admin-page-loader"><span></span><span></span><span></span></div>')},show_hide_element_on_change:function(){a(".show-hide-trigger input, .show-hide-trigger select").on("change",(function(){a(".quick-ajax-field-container[data-conditional]").each((function(){const t=a(this),n=t.data("conditional");let e=!0;for(const t in n){if(!n.hasOwnProperty(t))continue;const _=n[t],o=a("#"+t);if((o.is(":checkbox")?o.is(":checked")?"1":"0":o.val())!==_){e=!1;break}}e?t.removeClass("inactive"):t.addClass("inactive")}))}))},quick_ajax_tabs:function(){if(a(".quick-ajax-tabs").length){const t=a(".quick-ajax-tab-button"),n=a(".quick-ajax-tab-content");t.on("click",(function(e){e.preventDefault();const _=a(this).data("tab");t.removeClass("active").attr("aria-selected","false").attr("tabindex","-1"),n.removeClass("active").attr("hidden",!0),a(this).addClass("active").attr("aria-selected","true").attr("tabindex","0"),a("#"+_).addClass("active").attr("hidden",!1)})),t.on("keydown",(function(a){const n=t.index(this);let e;if("ArrowRight"===a.key)e=(n+1)%t.length;else{if("ArrowLeft"!==a.key)return;e=(n-1+t.length)%t.length}t.eq(e).focus().click()}))}},copy_code:function(){a(".copy-button").on("click",(function(){var t=a("#"+a(this).data("copy")),n=a("<textarea>").val(t.text()).appendTo("body").select();try{navigator.clipboard.writeText(t.text()).then((()=>{})).catch((a=>{}))}finally{n.remove(),a(this).text("Code Copied"),setTimeout((()=>{a(this).text("Copy Code")}),2e3)}}))},generateId:function(a){let t=0;for(let n=0;n<a.length;n++)t+=a.charCodeAt(n),n%2==0?t+=a.charCodeAt(n):t-=a.charCodeAt(n);return t},getExcludedPostIds:function(a){var t=a.split(/[,\s]+/),n=[];return t.forEach((function(a){/^\d+$/.test(a)&&-1===n.indexOf(a)&&n.push(a)})),n.join(", ")},cleanClassNames:function(a){let t=a.replace(/,/g," ").split(/\s+/);return t=t.filter(((a,t,n)=>!/^\d/.test(a)&&""!==a&&n.indexOf(a)===t)),t.join(", ")},qapl_collect_input_data:function(){const t={};return a(".function-generator-wrap input, .function-generator-wrap select").each((function(n,e){const _=a(e),o=_.attr("name"),i=_.attr("id");if("checkbox"===e.type)if(o&&o.endsWith("[]")){let a=o.replace(/\[\]$/,"");t[a]||(t[a]=[]),_.prop("checked")&&t[a].push(_.val())}else t[i]=_.prop("checked")?1:0;else t[i]=_.val()})),t},qapl_generate_args:function(a){const t=this;let n="",e="",_="";(n+="$quick_ajax_args = [\n",n+="    'post_type' => '"+a.qapl_select_post_type+"',\n",n+="    'posts_per_page' => "+a.qapl_select_posts_per_page+",\n","none"!==a.qapl_select_orderby&&(n+="    'orderby' => '"+a.qapl_select_orderby+"',\n"),n+="    'order' => '"+a.qapl_select_order+"',\n",""!==a.qapl_select_post_not_in)&&(n+="    'post__not_in' => ["+t.getExcludedPostIds(a.qapl_select_post_not_in)+"],\n");if(1===a.qapl_ignore_sticky_posts&&(n+="    'ignore_sticky_posts' => "+a.qapl_ignore_sticky_posts+",\n"),1===a.qapl_show_select_taxonomy&&(n+="    'selected_taxonomy' => '"+a.qapl_select_taxonomy+"',\n"),1===a.qapl_show_select_taxonomy&&1===a.qapl_manual_term_selection){var o=a.qapl_manual_selected_terms;o&&o.length>0&&(e="[",e+=o.map((a=>`${a}`)).join(", "),e+="]"),e&&(n+="    'selected_terms' => "+e+",\n")}let i=n.trimEnd();return i.endsWith(",")&&(n=i.slice(0,-1)+"\n"),n+="];",""!==n.trim()&&(_+="\n// Define AJAX query parameters for '"+a.qapl_select_post_type+"' type posts.\n",_+=n.trim()+"\n"),_},qapl_generate_attributes:function(a,t){const n=this;let e={},_="";e[qapl_quick_ajax_admin_data.constants.quick_ajax_id]=t,1===a.qapl_layout_quick_ajax_css_style&&(e[qapl_quick_ajax_admin_data.constants.quick_ajax_css_style]=a.qapl_layout_quick_ajax_css_style,e[qapl_quick_ajax_admin_data.constants.grid_num_columns]=a.qapl_layout_select_columns_qty),a.qapl_layout_quick_ajax_post_item_template&&(e[qapl_quick_ajax_admin_data.constants.post_item_template]=a.qapl_layout_quick_ajax_post_item_template),a.qapl_layout_add_taxonomy_filter_class&&""!==a.qapl_layout_add_taxonomy_filter_class&&(e[qapl_quick_ajax_admin_data.constants.taxonomy_filter_class]=n.cleanClassNames(a.qapl_layout_add_taxonomy_filter_class)),a.qapl_layout_add_container_class&&""!==a.qapl_layout_add_container_class&&(e[qapl_quick_ajax_admin_data.constants.container_class]=n.cleanClassNames(a.qapl_layout_add_container_class)),1===a.qapl_show_custom_load_more_post_quantity&&(e[qapl_quick_ajax_admin_data.constants.load_more_posts]=a.qapl_select_custom_load_more_post_quantity),1===a.qapl_override_global_loader_icon&&(e[qapl_quick_ajax_admin_data.constants.loader_icon]=a.qapl_loader_icon),1===a.qapl_ajax_on_initial_load&&(e[qapl_quick_ajax_admin_data.constants.ajax_initial_load]=a.qapl_ajax_on_initial_load),1===a.qapl_ajax_infinite_scroll&&(e[qapl_quick_ajax_admin_data.constants.infinite_scroll]=a.qapl_ajax_infinite_scroll),1===a.qapl_show_end_post_message&&(e[qapl_quick_ajax_admin_data.constants.show_end_message]=a.qapl_show_end_post_message);var o="";return Object.keys(e).length>0&&(o="",o+="$quick_ajax_attributes = [\n",Object.entries(e).forEach((([a,t])=>{let e;e=n.quick_ajax_is_numeric(t)?parseInt(t):"string"==typeof t?`'${t}'`:t,o+=`    '${a}' => ${e},\n`})),o=o.slice(0,-2)+"\n",o+="];"),""!==o.trim()&&(_+="\n// Define attributes for AJAX.\n",_+=o.trim()+"\n"),_},qapl_generate_sort_controls:function(a){let t=null,n=null;1===a.qapl_show_order_button&&(t=a.qapl_select_orderby_button_options,t&&t.length>0&&(n="$quick_ajax_sort_options = [",n+=t.map((a=>`'${a}'`)).join(", "),n+="];"));var e="",_="";null!==t&&n&&(e="",e+=n,_="",_+="if(function_exists('qapl_render_sort_controls')){\n",_+="    qapl_render_sort_controls(\n",_+="        $quick_ajax_args,\n",_+="        $quick_ajax_attributes,\n",_+="        $quick_ajax_sort_options\n",_+="    );\n",_+="}");let o="";return"string"==typeof e&&""!==e.trim()&&(o+="\n// Set the sort options for the button.\n",o+=e.trim()+"\n"),"string"==typeof _&&""!==_.trim()&&(o+="\n// Render the sorting control button.\n",o+=_.trim()+"\n"),o},qapl_generate_taxonomy_filter:function(a){let t=null,n="",e="";return 1===a.qapl_show_select_taxonomy&&(t=a.qapl_select_taxonomy),null!==t&&(e+="if(function_exists('qapl_render_taxonomy_filter')){\n",e+="    qapl_render_taxonomy_filter(\n",e+="        $quick_ajax_args,\n",e+="        $quick_ajax_attributes,\n",e=e.slice(0,-2)+"\n",e+="    );\n",e+="}"),""!==e.trim()&&(n+="\n// Render the navigation for '"+a.qapl_select_taxonomy+"' taxonomy.\n",n+=e.trim()+"\n"),n},qapl_generate_post_container:function(a,t){let n="",e="";return e+="if(function_exists('qapl_render_post_container')){\n",e+="   qapl_render_post_container(\n",e+="       $quick_ajax_args,\n",""!==t&&(e+="       $quick_ajax_attributes,\n"),e=e.slice(0,-2)+"\n",e+="   );\n",e+="}",""!==e.trim()&&(n+="\n// Render the grid for '"+a.qapl_select_post_type+"' type posts.\n",n+=e.trim()+"\n"),n},quick_ajax_function_generator:function(){const t=this;this.data_available&&a(".generate-function-button").on("click",(function(){const n=a(this),e=n.attr("data-output"),_=a("#"+e),o=a('.copy-button[data-copy="'+e+'"]');n.prop("disabled",!0),o.prop("disabled",!0);const i=t.qapl_collect_input_data(),c=Object.values(i).join(""),s=t.generateId(c),l=t.qapl_generate_args(i),r=t.qapl_generate_attributes(i,s),d=[l,r,t.qapl_generate_sort_controls(i),t.qapl_generate_taxonomy_filter(i),t.qapl_generate_post_container(i,r)].filter(Boolean).join("");_.empty();for(var p=d.split("\n"),u=0;u<p.length;u++)!function(a){setTimeout((function(){_.append(p[a]+"\n"),a===p.length-1&&(n.prop("disabled",!1),o.prop("disabled",!1))}),50*u)}(u)}))},quick_ajax_is_numeric:function(a){return/^-?\d+(\.\d+)?$/.test(a)},quick_ajax_color_picker:function(){a(".color-picker-field").wpColorPicker()},quick_ajax_select_text:function(a){var t,n;document.body.createTextRange?((t=document.body.createTextRange()).moveToElementText(a),t.select()):window.getSelection&&(n=window.getSelection(),(t=document.createRange()).selectNodeContents(a),n.removeAllRanges(),n.addRange(t))},click_and_select_shortcode:function(){const t=this;a(".quick-ajax-shortcode").on("click",(function(){t.quick_ajax_select_text(this)}))},click_and_select_all:function(){const t=this;a(".click-and-select-all").on("click",(function(){var n=a(this).find("code").get(0);t.quick_ajax_select_text(n)}))},accordion_block_toggle:function(){var t=a("#wpbody-content");if(t.find(".quick-ajax-tabs").length>0){var n=a("#adminmenuwrap").outerHeight();t.css("min-height",n)}a(".quick-ajax-accordion-toggle").click((function(){a(this).toggleClass("active").next(".quick-ajax-accordion-content").slideToggle(200)}))}};a(document).ready((function(){t.init()}))}(jQuery);